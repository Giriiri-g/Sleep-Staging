# This script parses the provided training log text and plots metrics across epochs.
# It generates separate plots for AUC, F1, Precision, and Recall.

import re
import matplotlib.pyplot as plt

log_text = """
Epoch 001 | AUC: 0.6027 | F1: 0.3478 | P: 0.4444 | R: 0.2857
Epoch 002 | AUC: 0.6417 | F1: 0.4561 | P: 0.4483 | R: 0.4643
Epoch 003 | AUC: 0.6830 | F1: 0.4839 | P: 0.4412 | R: 0.5357
Epoch 004 | AUC: 0.7015 | F1: 0.5169 | P: 0.3770 | R: 0.8214
Epoch 005 | AUC: 0.6903 | F1: 0.4815 | P: 0.5000 | R: 0.4643
Epoch 006 | AUC: 0.7143 | F1: 0.5500 | P: 0.4231 | R: 0.7857
Epoch 007 | AUC: 0.7188 | F1: 0.5476 | P: 0.4107 | R: 0.8214
Epoch 008 | AUC: 0.7176 | F1: 0.4783 | P: 0.6111 | R: 0.3929
Epoch 009 | AUC: 0.7472 | F1: 0.4898 | P: 0.5714 | R: 0.4286
Epoch 010 | AUC: 0.7467 | F1: 0.5085 | P: 0.4839 | R: 0.5357
Epoch 011 | AUC: 0.7695 | F1: 0.5833 | P: 0.4773 | R: 0.7500
Epoch 012 | AUC: 0.7829 | F1: 0.4956 | P: 0.3294 | R: 1.0000
Epoch 013 | AUC: 0.7506 | F1: 0.4651 | P: 0.6667 | R: 0.3571
Epoch 014 | AUC: 0.7801 | F1: 0.5758 | P: 0.5000 | R: 0.6786
Epoch 015 | AUC: 0.7824 | F1: 0.2857 | P: 0.7143 | R: 0.1786
Epoch 016 | AUC: 0.7930 | F1: 0.4651 | P: 0.6667 | R: 0.3571
Epoch 017 | AUC: 0.8170 | F1: 0.6269 | P: 0.5385 | R: 0.7500
Epoch 018 | AUC: 0.7718 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 019 | AUC: 0.8181 | F1: 0.4286 | P: 0.6429 | R: 0.3214
Epoch 020 | AUC: 0.8175 | F1: 0.6000 | P: 0.4355 | R: 0.9643
Epoch 021 | AUC: 0.8086 | F1: 0.1935 | P: 1.0000 | R: 0.1071
Epoch 022 | AUC: 0.8158 | F1: 0.5000 | P: 0.6875 | R: 0.3929
Epoch 023 | AUC: 0.8404 | F1: 0.5234 | P: 0.3544 | R: 1.0000
Epoch 024 | AUC: 0.7980 | F1: 0.6136 | P: 0.4500 | R: 0.9643
Epoch 025 | AUC: 0.8064 | F1: 0.5143 | P: 0.3506 | R: 0.9643
Epoch 026 | AUC: 0.8337 | F1: 0.6353 | P: 0.4737 | R: 0.9643
Epoch 027 | AUC: 0.8398 | F1: 0.6190 | P: 0.4643 | R: 0.9286
Epoch 028 | AUC: 0.8186 | F1: 0.6341 | P: 0.4815 | R: 0.9286
Epoch 029 | AUC: 0.7946 | F1: 0.5926 | P: 0.6154 | R: 0.5714
Epoch 030 | AUC: 0.7952 | F1: 0.4681 | P: 0.5789 | R: 0.3929
Epoch 031 | AUC: 0.8108 | F1: 0.5846 | P: 0.5135 | R: 0.6786
Epoch 032 | AUC: 0.8069 | F1: 0.1333 | P: 1.0000 | R: 0.0714
Epoch 033 | AUC: 0.8103 | F1: 0.5652 | P: 0.7222 | R: 0.4643
Epoch 034 | AUC: 0.8270 | F1: 0.6377 | P: 0.5366 | R: 0.7857
Epoch 035 | AUC: 0.7701 | F1: 0.5495 | P: 0.3968 | R: 0.8929
Epoch 036 | AUC: 0.7740 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 037 | AUC: 0.7734 | F1: 0.5393 | P: 0.3934 | R: 0.8571
Epoch 038 | AUC: 0.7517 | F1: 0.1667 | P: 0.3750 | R: 0.1071
Epoch 039 | AUC: 0.7969 | F1: 0.5283 | P: 0.5600 | R: 0.5000
Epoch 040 | AUC: 0.7768 | F1: 0.5045 | P: 0.3373 | R: 1.0000
Epoch 041 | AUC: 0.7958 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 042 | AUC: 0.8214 | F1: 0.5185 | P: 0.3500 | R: 1.0000
Epoch 043 | AUC: 0.7790 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 044 | AUC: 0.8002 | F1: 0.6494 | P: 0.5102 | R: 0.8929
Epoch 045 | AUC: 0.7829 | F1: 0.5185 | P: 0.5385 | R: 0.5000
Epoch 046 | AUC: 0.7952 | F1: 0.5714 | P: 0.6667 | R: 0.5000
Epoch 047 | AUC: 0.7101 | F1: 0.4706 | P: 0.3077 | R: 1.0000
Epoch 048 | AUC: 0.7257 | F1: 0.4706 | P: 0.3077 | R: 1.0000
Epoch 049 | AUC: 0.7729 | F1: 0.1250 | P: 0.5000 | R: 0.0714
Epoch 050 | AUC: 0.8092 | F1: 0.6364 | P: 0.5526 | R: 0.7500
Epoch 051 | AUC: 0.7829 | F1: 0.0690 | P: 1.0000 | R: 0.0357
Epoch 052 | AUC: 0.8114 | F1: 0.5843 | P: 0.4262 | R: 0.9286
Epoch 053 | AUC: 0.7556 | F1: 0.4681 | P: 0.5789 | R: 0.3929
Epoch 054 | AUC: 0.6847 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 055 | AUC: 0.7383 | F1: 0.4643 | P: 0.4643 | R: 0.4643
Epoch 056 | AUC: 0.7595 | F1: 0.2424 | P: 0.8000 | R: 0.1429
Epoch 057 | AUC: 0.7645 | F1: 0.1333 | P: 1.0000 | R: 0.0714
Epoch 058 | AUC: 0.7824 | F1: 0.5385 | P: 0.5833 | R: 0.5000
Epoch 059 | AUC: 0.7874 | F1: 0.5098 | P: 0.3514 | R: 0.9286
Epoch 060 | AUC: 0.7946 | F1: 0.3333 | P: 0.7500 | R: 0.2143
Epoch 061 | AUC: 0.7757 | F1: 0.5714 | P: 0.4286 | R: 0.8571
Epoch 062 | AUC: 0.7907 | F1: 0.5660 | P: 0.6000 | R: 0.5357
Epoch 063 | AUC: 0.8142 | F1: 0.5510 | P: 0.3857 | R: 0.9643
Epoch 064 | AUC: 0.7600 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 065 | AUC: 0.7411 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 066 | AUC: 0.7533 | F1: 0.1250 | P: 0.5000 | R: 0.0714
Epoch 067 | AUC: 0.7506 | F1: 0.4286 | P: 0.6429 | R: 0.3214
Epoch 068 | AUC: 0.8175 | F1: 0.5000 | P: 0.3333 | R: 1.0000
Epoch 069 | AUC: 0.7729 | F1: 0.0690 | P: 1.0000 | R: 0.0357
Epoch 070 | AUC: 0.7327 | F1: 0.5581 | P: 0.4138 | R: 0.8571
Epoch 071 | AUC: 0.7612 | F1: 0.6053 | P: 0.4792 | R: 0.8214
Epoch 072 | AUC: 0.7556 | F1: 0.6032 | P: 0.5429 | R: 0.6786
Epoch 073 | AUC: 0.7533 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 074 | AUC: 0.7623 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 075 | AUC: 0.7746 | F1: 0.5532 | P: 0.6842 | R: 0.4643
Epoch 076 | AUC: 0.7321 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 077 | AUC: 0.7405 | F1: 0.4706 | P: 0.3077 | R: 1.0000
Epoch 078 | AUC: 0.7902 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 079 | AUC: 0.7584 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 080 | AUC: 0.7684 | F1: 0.0667 | P: 0.5000 | R: 0.0357
Epoch 081 | AUC: 0.7863 | F1: 0.5500 | P: 0.4231 | R: 0.7857
Epoch 082 | AUC: 0.8019 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 083 | AUC: 0.7757 | F1: 0.4821 | P: 0.3214 | R: 0.9643
Epoch 084 | AUC: 0.7958 | F1: 0.5200 | P: 0.3611 | R: 0.9286
Epoch 085 | AUC: 0.7545 | F1: 0.5818 | P: 0.5926 | R: 0.5714
Epoch 086 | AUC: 0.7249 | F1: 0.5843 | P: 0.4262 | R: 0.9286
Epoch 087 | AUC: 0.7857 | F1: 0.6269 | P: 0.5385 | R: 0.7500
Epoch 088 | AUC: 0.7812 | F1: 0.1935 | P: 1.0000 | R: 0.1071
Epoch 089 | AUC: 0.8454 | F1: 0.6207 | P: 0.4576 | R: 0.9643
Epoch 090 | AUC: 0.7260 | F1: 0.4828 | P: 0.3182 | R: 1.0000
Epoch 091 | AUC: 0.7757 | F1: 0.4783 | P: 0.6111 | R: 0.3929
Epoch 092 | AUC: 0.8164 | F1: 0.6122 | P: 0.7143 | R: 0.5357
Epoch 093 | AUC: 0.8181 | F1: 0.5192 | P: 0.3553 | R: 0.9643
Epoch 094 | AUC: 0.7701 | F1: 0.5385 | P: 0.5833 | R: 0.5000
Epoch 095 | AUC: 0.8047 | F1: 0.5660 | P: 0.6000 | R: 0.5357
Epoch 096 | AUC: 0.8186 | F1: 0.1818 | P: 0.6000 | R: 0.1071
Epoch 097 | AUC: 0.8131 | F1: 0.5778 | P: 0.4194 | R: 0.9286
Epoch 098 | AUC: 0.7896 | F1: 0.5283 | P: 0.5600 | R: 0.5000
Epoch 099 | AUC: 0.7913 | F1: 0.6000 | P: 0.5625 | R: 0.6429
Epoch 100 | AUC: 0.7885 | F1: 0.5769 | P: 0.6250 | R: 0.5357
Epoch 101 | AUC: 0.7919 | F1: 0.6000 | P: 0.6818 | R: 0.5357
Epoch 102 | AUC: 0.7863 | F1: 0.5769 | P: 0.6250 | R: 0.5357
Epoch 103 | AUC: 0.7896 | F1: 0.6316 | P: 0.6207 | R: 0.6429
Epoch 104 | AUC: 0.7824 | F1: 0.5769 | P: 0.6250 | R: 0.5357
Epoch 105 | AUC: 0.7718 | F1: 0.5769 | P: 0.6250 | R: 0.5357
Epoch 106 | AUC: 0.7852 | F1: 0.5306 | P: 0.6190 | R: 0.4643
Epoch 107 | AUC: 0.7840 | F1: 0.5556 | P: 0.5769 | R: 0.5357
Epoch 108 | AUC: 0.8069 | F1: 0.6769 | P: 0.5946 | R: 0.7857
Epoch 109 | AUC: 0.7785 | F1: 0.4500 | P: 0.7500 | R: 0.3214
Epoch 110 | AUC: 0.8097 | F1: 0.5047 | P: 0.3418 | R: 0.9643
Epoch 111 | AUC: 0.7807 | F1: 0.3810 | P: 0.5714 | R: 0.2857
Epoch 112 | AUC: 0.7734 | F1: 0.5385 | P: 0.5833 | R: 0.5000
Epoch 113 | AUC: 0.7874 | F1: 0.5652 | P: 0.7222 | R: 0.4643
Epoch 114 | AUC: 0.7941 | F1: 0.5833 | P: 0.7000 | R: 0.5000
Epoch 115 | AUC: 0.7902 | F1: 0.2941 | P: 0.8333 | R: 0.1786
Epoch 116 | AUC: 0.7656 | F1: 0.5797 | P: 0.4878 | R: 0.7143
Epoch 117 | AUC: 0.7785 | F1: 0.6087 | P: 0.5122 | R: 0.7500
Epoch 118 | AUC: 0.7712 | F1: 0.5333 | P: 0.7059 | R: 0.4286
Epoch 119 | AUC: 0.8002 | F1: 0.3590 | P: 0.6364 | R: 0.2500
Epoch 120 | AUC: 0.7751 | F1: 0.4615 | P: 0.8182 | R: 0.3214
Epoch 121 | AUC: 0.7935 | F1: 0.6301 | P: 0.5111 | R: 0.8214
Epoch 122 | AUC: 0.7796 | F1: 0.6053 | P: 0.4792 | R: 0.8214
Epoch 123 | AUC: 0.7796 | F1: 0.5714 | P: 0.6667 | R: 0.5000
Epoch 124 | AUC: 0.7840 | F1: 0.6154 | P: 0.6667 | R: 0.5714
Epoch 125 | AUC: 0.7980 | F1: 0.5094 | P: 0.3462 | R: 0.9643
Epoch 126 | AUC: 0.8192 | F1: 0.5283 | P: 0.3590 | R: 1.0000
Epoch 127 | AUC: 0.7525 | F1: 0.4954 | P: 0.3333 | R: 0.9643
Epoch 128 | AUC: 0.7930 | F1: 0.5000 | P: 0.3333 | R: 1.0000
Epoch 129 | AUC: 0.7946 | F1: 0.5915 | P: 0.4884 | R: 0.7500
Epoch 130 | AUC: 0.7628 | F1: 0.4783 | P: 0.6111 | R: 0.3929
Epoch 131 | AUC: 0.7673 | F1: 0.0690 | P: 1.0000 | R: 0.0357
Epoch 132 | AUC: 0.7997 | F1: 0.5000 | P: 0.3421 | R: 0.9286
Epoch 133 | AUC: 0.7818 | F1: 0.5217 | P: 0.6667 | R: 0.4286
Epoch 134 | AUC: 0.7779 | F1: 0.3243 | P: 0.6667 | R: 0.2143
Epoch 135 | AUC: 0.7746 | F1: 0.5769 | P: 0.6250 | R: 0.5357
Epoch 136 | AUC: 0.8365 | F1: 0.3684 | P: 0.7000 | R: 0.2500
Epoch 137 | AUC: 0.6981 | F1: 0.0000 | P: 0.0000 | R: 0.0000
Epoch 138 | AUC: 0.7891 | F1: 0.4746 | P: 0.3111 | R: 1.0000
Epoch 139 | AUC: 0.7907 | F1: 0.5745 | P: 0.4091 | R: 0.9643
Epoch 140 | AUC: 0.7589 | F1: 0.5946 | P: 0.4783 | R: 0.7857
Epoch 141 | AUC: 0.7667 | F1: 0.5532 | P: 0.6842 | R: 0.4643
Epoch 142 | AUC: 0.7684 | F1: 0.6207 | P: 0.6000 | R: 0.6429
Epoch 143 | AUC: 0.7863 | F1: 0.5882 | P: 0.6522 | R: 0.5357
Epoch 144 | AUC: 0.7751 | F1: 0.5926 | P: 0.6154 | R: 0.5714
Epoch 145 | AUC: 0.7919 | F1: 0.5763 | P: 0.5484 | R: 0.6071
Epoch 146 | AUC: 0.7796 | F1: 0.5862 | P: 0.5667 | R: 0.6071
Epoch 147 | AUC: 0.7902 | F1: 0.6250 | P: 0.7500 | R: 0.5357
Epoch 148 | AUC: 0.7974 | F1: 0.5490 | P: 0.6087 | R: 0.5000
Epoch 149 | AUC: 0.7874 | F1: 0.3684 | P: 0.7000 | R: 0.2500
Epoch 150 | AUC: 0.7835 | F1: 0.3889 | P: 0.8750 | R: 0.2500"""

epochs, aucs, f1s, ps, rs = [], [], [], [], []

pattern = re.compile(r"Epoch (\d+).*AUC: ([\d.]+).*F1: ([\d.]+).*P: ([\d.]+).*R: ([\d.]+)")

for line in log_text.splitlines():
    m = pattern.search(line)
    if m:
        epochs.append(int(m.group(1)))
        aucs.append(float(m.group(2)))
        f1s.append(float(m.group(3)))
        ps.append(float(m.group(4)))
        rs.append(float(m.group(5)))

# Plot AUC
plt.figure()
plt.plot(epochs, aucs)
plt.xlabel("Epoch")
plt.ylabel("AUC")
plt.title("Validation AUC over Epochs")
plt.show()

# Plot F1
plt.figure()
plt.plot(epochs, f1s)
plt.xlabel("Epoch")
plt.ylabel("F1 Score")
plt.title("Validation F1 over Epochs")
plt.show()

# Plot Precision
plt.figure()
plt.plot(epochs, ps)
plt.xlabel("Epoch")
plt.ylabel("Precision")
plt.title("Validation Precision over Epochs")
plt.show()

# Plot Recall
plt.figure()
plt.plot(epochs, rs)
plt.xlabel("Epoch")
plt.ylabel("Recall")
plt.title("Validation Recall over Epochs")
plt.show()
